import React, { useEffect, useState } from "react";
import fetcher from "../../../services/apiFetcher";
import Header from "../../common/Header/Header";
import RafflesCard from "../../common/RafflesCard/RafflesCard";
import BottomNavbar from "../../common/BottomNavbar/BottomNavbar";
import Shimmer from "../../common/Shimmer/Shimmer";

export default function RafflesPage() {
  const [raffles, setRaffles] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchRaffles = async () => {
      try {
        const response = await fetcher.get("/users/contests");
        setRaffles(response);
      } catch (error) {
        console.error("Error fetching raffles:", error);
      } finally {
        setLoading(false);
      }
    };

    fetchRaffles();
  }, []);

  return (
    <div className="bg-[#1E1E1E] h-auto pb-14 w-screen">
      <Header />
      <div className="m-4 flex justify-center items-center">
        <svg
          width="80"
          height="20"
          viewBox="0 0 56 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4.01202 0.659999L5.21802 6.42H5.29002L6.37002 0.659999H9.70002V12H7.25202V5.538H7.18002L5.93802 12H4.28202L3.00402 5.538H2.93202V12H0.610024V0.659999H4.01202ZM12.0669 12.288L9.85293 3.972H12.3189L13.3089 8.328H13.3809L14.4249 3.972H16.6209L13.7229 14.88H11.3469L12.0669 12.288ZM25.6646 12H23.0546C22.9106 11.568 22.8746 10.902 22.8026 9.534C22.7486 8.454 22.4786 7.896 21.6506 7.896H21.3086V12H18.6986V0.659999H21.9566C24.4946 0.659999 25.6286 1.992 25.6286 4.008C25.6286 5.79 24.8186 6.672 23.6666 6.87C24.8546 7.14 25.2506 7.986 25.3406 9.408C25.4306 10.902 25.4126 11.478 25.6646 12ZM21.3086 5.808H21.5606C22.6226 5.808 23.0366 5.466 23.0366 4.314C23.0366 3.288 22.6226 2.784 21.5606 2.784H21.3086V5.808ZM29.2756 9.318V8.544L28.8076 8.85C28.3936 9.102 28.1056 9.3 28.1056 9.75C28.1056 10.092 28.3036 10.29 28.6276 10.29C29.0776 10.29 29.2756 9.876 29.2756 9.318ZM31.7236 6.708V9.966C31.7236 10.2 31.7776 10.308 31.9936 10.308C32.1016 10.308 32.1556 10.29 32.2996 10.254V11.748C31.9756 11.964 31.5796 12.126 31.0216 12.126C30.2836 12.126 29.7076 11.802 29.4556 11.118C29.1856 11.73 28.5196 12.126 27.7096 12.126C26.3776 12.126 25.7116 11.28 25.7116 10.164C25.7116 8.868 26.6116 8.274 27.9436 7.554L29.2756 6.834V6.564C29.2756 6.096 29.2036 5.772 28.7896 5.772C28.3756 5.772 28.2856 6.132 28.2856 6.564V6.942H25.9636V6.51C25.9636 4.926 26.8636 3.828 28.8616 3.828C30.7876 3.828 31.7236 4.8 31.7236 6.708ZM36.7388 3.972V3.108C36.7388 1.524 37.5668 0.516 39.0608 0.516C39.5288 0.516 39.8528 0.606 40.1768 0.731999V2.55C39.9968 2.46 39.8708 2.424 39.7088 2.424C39.3128 2.424 39.2408 2.694 39.2408 3.09V3.972H40.1768V5.718H39.2408V12H36.7388V5.718H35.3888V12H32.8868V5.718H32.1488V3.972H32.8868V3.252C32.8868 1.668 33.7148 0.659999 35.3528 0.659999C35.8748 0.659999 36.2168 0.75 36.5408 0.875999L36.3968 2.658C36.2528 2.586 36.0908 2.568 35.9468 2.568C35.4788 2.568 35.3888 2.838 35.3888 3.234V3.972H36.7388ZM40.5908 0.659999H43.1108V12H40.5908V0.659999ZM47.2607 7.14C47.2607 6.222 47.1527 5.754 46.6307 5.754C46.0907 5.754 45.9647 6.222 45.9647 7.14H47.2607ZM43.4627 8.184V7.788C43.4627 5.502 44.3447 3.828 46.6307 3.828C48.8987 3.828 49.6907 5.484 49.6907 7.77V8.598H45.9647V8.958C45.9647 9.732 46.0907 10.218 46.6667 10.218C47.1347 10.218 47.3147 9.894 47.3147 9.3V9.12H49.6367V9.246C49.6367 10.956 48.5747 12.144 46.7027 12.144C44.5067 12.144 43.4627 10.74 43.4627 8.184ZM49.8467 9.318H51.9887V9.48C51.9887 9.966 52.2407 10.29 52.7447 10.29C53.0867 10.29 53.2667 10.128 53.2667 9.822C53.2667 9.588 53.1587 9.426 52.7807 9.264L51.7547 8.832C50.6747 8.4 49.8827 7.716 49.8827 6.366C49.8827 4.89 50.9447 3.828 52.6907 3.828C54.4907 3.828 55.4987 4.818 55.4987 6.42V6.654H53.3387V6.51C53.3387 6.006 53.2307 5.682 52.7447 5.682C52.4387 5.682 52.2587 5.88 52.2587 6.15C52.2587 6.366 52.4027 6.564 52.6547 6.672L53.8427 7.194C54.8507 7.644 55.6607 8.274 55.6607 9.642C55.6607 11.226 54.5267 12.144 52.7807 12.144C50.9627 12.144 49.8467 11.208 49.8467 9.57V9.318Z"
            fill="white"
          />
        </svg>
      </div>
      {loading ? (
        <Shimmer />
      ) : (
        <div className="mx-[11px]">
          {raffles.map((raffle, index) => (
            <RafflesCard
              key={index}
              raffleData={raffle.contest}
              customWidth="w-full"
            />
          ))}
        </div>
      )}
      <BottomNavbar />
    </div>
  );
}
